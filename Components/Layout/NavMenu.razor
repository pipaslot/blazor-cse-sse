@namespace Components.Layout
@using IState = Fluxor.IState
@using Components.Store
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
@inject IState<Language.State> LanguageState
@inject App.Shared.IAuthService AuthService
@inject IJSRuntime Runtime

<MatNavMenu>
    <MatNavItem>
        @LanguageState.Value.Language
    </MatNavItem>
    <MatNavItem>
        <NavLink href="" Match="NavLinkMatch.All">
            <MatIcon>@MatIconNames.Home</MatIcon> @LayoutResource.Home
        </NavLink>
    </MatNavItem>
    <MatNavItem>
        <NavLink href="/about">
            <MatIcon>@MatIconNames.Feedback</MatIcon> About
        </NavLink>
    </MatNavItem>

    <MatNavItem>
        <AuthorizeView>
            <NotAuthorized>
                <NavLink href="/auth/sign-in">
                    <MatIcon>@MatIconNames.Favorite</MatIcon> Sign In
                </NavLink>
            </NotAuthorized>
            <Authorized>
                <NavLink @onclick="SignOut">
                    <MatIcon>@MatIconNames.Favorite</MatIcon> Sign Out
                </NavLink>
            </Authorized>
        </AuthorizeView>
    </MatNavItem>
</MatNavMenu>

@code{
    protected override void OnInitialized()
    {
        //LayoutResource.Culture = new System.Globalization.CultureInfo("cs");
        (Runtime as IJSInProcessRuntime)?.Invoke<string>("console.log", LayoutResource.Home);
        base.OnInitialized();
    }

    void SignOut()
    {
        AuthService.SignOut();
    }
}