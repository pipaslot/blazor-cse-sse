@using Components.States
@inherits Components.StateAbstraction.StatefullComponent
@inject AppState appState

<Flag Name="@appState.Language" @onclick="OpenMenu" @ref="flag"/> @appState.Language

<MatMenu @ref="menu">
    <MatList>
        @foreach (var lang in Languages)
        {
            <MatListItem @onclick="()=>SelectLanguage(lang)">
                <Flag Name="@lang" />@lang
            </MatListItem>
        }
    </MatList>
</MatMenu>

@code{
    Flag flag;
    MatMenu menu;

    string[] Languages = new string[]
    {
        "EN",
        "DE",
        "CZ"
                };
    protected override void OnInitialized()
    {
        Observe(appState);
    }

    void OpenMenu(MouseEventArgs e)
    {
        menu.OpenAsync(flag.Ref);
    }

    void SelectLanguage(string language)
    {
        appState.Language = language;
    }

}